<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Fruit Clash - ูุนุจุฉ ุงูููุงูู</title>
    
    <!-- PWA Support -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6C5CE7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style-modern.css">
</head>
<body>
    <!-- ุดุงุดุฉ ุงูุชุญููู ุงููุชุญุฑูุฉ -->
    <div id="splash-screen" class="screen splash-screen">
        <div class="splash-content">
            <div class="logo-animation">
                <div class="fruit-icon">๐</div>
                <div class="fruit-icon">๐</div>
                <div class="fruit-icon">๐</div>
                <div class="fruit-icon">๐</div>
            </div>
            <h1 class="game-title">FRUIT CLASH</h1>
            <p class="game-subtitle">ุงุฌูุน ุงูุฃุฑุจุนุฉ ุจุณุฑุนุฉ ุงูุจุฑู</p>
            <div class="modern-loader">
                <div class="loader-bar"></div>
            </div>
        </div>
    </div>

    <!-- ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ - ุชุตููู ุญุฏูุซ -->
    <div id="main-menu" class="screen menu-screen hidden">
        <div class="menu-bg-pattern"></div>
        <div class="menu-content">
            <div class="menu-header">
                <h1 class="menu-title">FRUIT CLASH</h1>
                <p class="menu-version">ุงูุฅุตุฏุงุฑ 2.0</p>
            </div>
            
            <div class="player-profile-card">
                <div class="player-avatar" id="player-avatar">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=player" alt="avatar">
                </div>
                <div class="player-info">
                    <span class="player-name-label">ุงููุงุนุจ</span>
                    <h3 id="player-name-display">ุฃุญูุฏ</h3>
                </div>
                <button class="edit-name-btn" id="edit-name-btn">
                    <i class="fas fa-pencil-alt"></i>
                </button>
            </div>
            
            <div class="menu-buttons-modern">
                <button id="create-room-btn" class="menu-btn primary-btn glow-effect">
                    <i class="fas fa-crown"></i>
                    <span>ุฅูุดุงุก ุบุฑูุฉ</span>
                </button>
                
                <button id="join-room-btn" class="menu-btn secondary-btn">
                    <i class="fas fa-user-plus"></i>
                    <span>ุงูุถูุงู ุณุฑูุน</span>
                </button>
                
                <button id="single-player-btn" class="menu-btn outline-btn">
                    <i class="fas fa-robot"></i>
                    <span>ุชุญุฏู ุงูููุจููุชุฑ</span>
                </button>
            </div>
            
            <div class="quick-play-section">
                <p class="section-label">ุฃู ุฌุฑุจ ุณุฑูุนุงู</p>
                <div class="quick-play-buttons">
                    <button class="quick-btn" onclick="quickJoinRandom()">
                        <i class="fas fa-dice"></i>
                        ุนุดูุงุฆู
                    </button>
                    <button class="quick-btn" onclick="openTutorial()">
                        <i class="fas fa-question"></i>
                        ุชุนูููุงุช
                    </button>
                </div>
            </div>
            
            <div class="online-stats">
                <div class="stat-item">
                    <span class="stat-value" id="online-count">128</span>
                    <span class="stat-label">ูุชุตู ุงูุขู</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="games-count">1.2k</span>
                    <span class="stat-label">ูุนุจุฉ ุงูููู</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุฅูุดุงุก ุงูุบุฑูุฉ - ุชุตููู ูุฑูุช ูุชุญุฑู -->
    <div id="lobby-screen" class="screen lobby-screen hidden">
        <div class="lobby-header">
            <button class="back-btn" onclick="goBack()">
                <i class="fas fa-arrow-right"></i>
            </button>
            <h2>ุบุฑูุฉ ุงูุงูุชุธุงุฑ</h2>
            <button class="settings-btn">
                <i class="fas fa-cog"></i>
            </button>
        </div>
        
        <div class="room-code-card">
            <span class="code-label">ุฑูุฒ ุงูุบุฑูุฉ</span>
            <div class="code-display" id="room-code">ABCD</div>
            <button class="copy-code-btn" onclick="copyRoomCode()">
                <i class="fas fa-copy"></i>
            </button>
        </div>
        
        <div class="qr-share-section">
            <div class="qr-preview" id="qr-code-container">
                <canvas id="qr-code"></canvas>
            </div>
            <p class="qr-hint">ุงูุณุญ ููุงูุถูุงู ุงูุณุฑูุน</p>
        </div>
        
        <div class="players-grid" id="players-grid">
            <!-- ุงููุงุนุจ ุงููุถูู -->
            <div class="player-card host-card">
                <div class="player-avatar large">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=host" alt="">
                </div>
                <div class="player-name">ุฃุญูุฏ</div>
                <div class="player-badge host-badge">ุงููุถูู</div>
            </div>
            
            <!-- ุฃูุงูู ูุงุฑุบุฉ (ุณุชุชููุฃ ุฏููุงููููุงู) -->
            <div class="player-card empty-card">
                <div class="empty-icon">๐ค</div>
                <div class="empty-text">ุงูุชุธุงุฑ...</div>
            </div>
            <div class="player-card empty-card">
                <div class="empty-icon">๐ค</div>
                <div class="empty-text">ุงูุชุธุงุฑ...</div>
            </div>
            <div class="player-card empty-card">
                <div class="empty-icon">๐ค</div>
                <div class="empty-text">ุงูุชุธุงุฑ...</div>
            </div>
        </div>
        
        <div class="lobby-footer">
            <button id="start-game-btn" class="start-btn disabled" disabled>
                <span>ุงุจุฏุฃ ุงููุนุจุฉ</span>
                <span class="player-count" id="player-count">1/4</span>
            </button>
            
            <div class="invite-options">
                <button class="invite-btn" onclick="shareInvite()">
                    <i class="fab fa-whatsapp"></i>
                </button>
                <button class="invite-btn" onclick="shareInvite()">
                    <i class="fas fa-share-alt"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงููุนุจ ุงูุฑุฆูุณูุฉ - ุชุตููู ุนุตุฑู -->
    <div id="game-screen" class="screen game-screen hidden">
        <!-- ุงูููุฏุฑ ุงููุชุญุฑู -->
        <div class="game-header-modern">
            <div class="timer-circle" id="timer-circle">
                <svg viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" class="timer-bg"/>
                    <circle cx="50" cy="50" r="45" class="timer-progress" id="timer-progress"/>
                </svg>
                <span class="timer-text" id="game-timer">60</span>
            </div>
            
            <div class="round-info">
                <span class="round-badge">ุงูุฌููุฉ <span id="round-number">1</span></span>
                <span class="category-badge" id="game-category">
                    <i class="fas fa-apple-alt"></i> ููุงูู
                </span>
            </div>
            
            <button class="menu-dots-btn" onclick="showGameMenu()">
                <i class="fas fa-ellipsis-v"></i>
            </button>
        </div>
        
        <!-- ุดุฑูุท ุชูุฏู ุงููุงุนุจูู -->
        <div class="players-progress" id="players-progress">
            <!-- ุณุชุชุนุจุฃ ุฏููุงููููุงู -->
        </div>
        
        <!-- ููุทูุฉ ุงูุจุทุงูุงุช ุงูุฑุฆูุณูุฉ -->
        <div class="game-area">
            <div class="cards-section">
                <div class="section-header">
                    <h3>ุจุทุงูุงุชู</h3>
                    <span class="cards-counter" id="cards-count">0/4</span>
                </div>
                
                <div class="cards-grid" id="cards-container">
                    <!-- ุงูุจุทุงูุงุช ุณุชุธูุฑ ููุง -->
                </div>
            </div>
            
            <!-- ุฒุฑ ุงูููุฒ ุงูุถุฎู -->
            <button id="done-button" class="win-button disabled" disabled>
                <div class="win-button-inner">
                    <i class="fas fa-bolt"></i>
                    <span>ุชู! 4 ูู ููุณ ุงูููุน</span>
                </div>
                <div class="win-button-glow"></div>
            </button>
            
            <!-- ุดุฑูุท ุงูุฅุฌุฑุงุกุงุช -->
            <div class="action-toast" id="action-log">
                <i class="fas fa-circle-notch fa-spin"></i>
                <span>ูู ุงูุชุธุงุฑ ุฏูุฑู...</span>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงููุชุงุฆุฌ ุงููุชุญุฑูุฉ -->
    <div id="result-modal" class="modal hidden">
        <div class="modal-overlay"></div>
        <div class="modal-content modern-modal">
            <div class="confetti" id="confetti"></div>
            <div class="winner-avatar" id="winner-avatar">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=winner" alt="">
            </div>
            <h2 id="result-title" class="winner-title">ุฃุญูุฏ ูุงุฒ!</h2>
            <p id="result-message" class="winner-message">ุชููู ูู ุฌูุน 4 ุชูุงุญุงุช ูู 23 ุซุงููุฉ</p>
            
            <div class="winner-stats">
                <div class="winner-stat">
                    <span class="stat-value" id="round-time">23s</span>
                    <span class="stat-label">ุฒูู ุงูููุฒ</span>
                </div>
                <div class="winner-stat">
                    <span class="stat-value" id="win-streak">1</span>
                    <span class="stat-label">ููุฒ ูุชุชุงูู</span>
                </div>
            </div>
            
            <div class="modal-actions">
                <button id="next-round-btn" class="modal-btn primary">
                    <i class="fas fa-redo-alt"></i>
                    ุงูุฌููุฉ ุงูุชุงููุฉ
                </button>
                <button id="end-game-btn" class="modal-btn secondary">
                    <i class="fas fa-home"></i>
                    ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
                </button>
            </div>
        </div>
    </div>

    <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
    <div id="side-menu" class="side-menu hidden">
        <div class="side-menu-header">
            <div class="close-menu" onclick="closeSideMenu()">
                <i class="fas fa-times"></i>
            </div>
            <div class="menu-profile">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=profile" alt="">
                <h4 id="menu-player-name">ุฃุญูุฏ</h4>
            </div>
        </div>
        <div class="side-menu-items">
            <button class="menu-item" onclick="showSettings()">
                <i class="fas fa-sliders-h"></i>
                <span>ุงูุฅุนุฏุงุฏุงุช</span>
            </button>
            <button class="menu-item" onclick="showStats()">
                <i class="fas fa-chart-line"></i>
                <span>ุฅุญุตุงุฆูุงุชู</span>
            </button>
            <button class="menu-item" onclick="showHowToPlay()">
                <i class="fas fa-question-circle"></i>
                <span>ููู ุชูุนุจ</span>
            </button>
            <button class="menu-item" onclick="shareApp()">
                <i class="fas fa-share-alt"></i>
                <span>ุดุงุฑู ุงูุชุทุจูู</span>
            </button>
            <button class="menu-item danger" onclick="leaveGame()">
                <i class="fas fa-sign-out-alt"></i>
                <span>ุฎุฑูุฌ</span>
            </button>
        </div>
        <div class="side-menu-footer">
            <p>ุงูุฅุตุฏุงุฑ 2.0.0</p>
        </div>
    </div>

    <!-- ููุชุจุงุช ุฎุงุฑุฌูุฉ -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1"></script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    // ุชุฃูุฏ ูู ุฃู ุงููุนุจุฉ ุชููุฃุช ุจุดูู ุตุญูุญ
    setTimeout(function() {
        if (!window.game) {
            console.error('ุงููุนุจุฉ ูู ุชููุฃ ุจุดูู ุตุญูุญ');
            window.game = new ModernGame();
        }
    }, 100);
});
</script>
    <!-- ูููุงุช ุงููุนุจุฉ -->
    <script src="game-modern.js"></script>
    <script>
// ุชููุฆุฉ ุงููุนุจุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
document.addEventListener('DOMContentLoaded', function() {
    // ุชุฃูุฏ ูู ุฃู ุงููุนุจุฉ ุชููุฃุช ุจุดูู ุตุญูุญ
    setTimeout(function() {
        if (!window.game) {
            console.error('ุงููุนุจุฉ ูู ุชููุฃ ุจุดูู ุตุญูุญ');
            window.game = new ModernGame();
        }
    }, 100);
});

// ุฏุงูุฉ ููุชุนุงูู ูุน ูุนููุงุช URL (ูุซู ุฑูุฒ ุงูุบุฑูุฉ)
window.addEventListener('load', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const joinCode = urlParams.get('join');
    if (joinCode && window.game) {
        setTimeout(() => {
            window.game.joinRoom(joinCode.toUpperCase());
        }, 500);
    }
});
</script>
</body>
</html>
